<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Admin Dashboard</title>
    <style>
        body { font-family: Arial; max-width: 1100px; margin: 20px auto; }
        h2 { margin-top: 0; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 6px 8px; font-size: 13px; }
        th { background: #ffe0b2; }
        .section-title { background: #ffcc80; padding: 6px 10px; margin: 15px 0 5px; border-radius: 4px; }
        .btn-delete { background: #ff5252; border: none; color: white; padding: 4px 8px; cursor: pointer;
                      border-radius: 4px; font-size: 12px; }
        .btn-delete:hover { opacity: 0.85; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; }
        .message { margin: 10px 0; color: green; }
        .error { margin: 10px 0; color: red; }
        a.small-link { font-size: 12px; margin-right: 10px; }
    </style>
</head>
<body>
<jsp:include page="navbar.jsp"/>

<div class="top-bar">
    <h2>Admin Dashboard</h2>
    <div>
        <span>Logged in as: ${sessionScope.userName}</span>
    </div>
</div>

<c:if test="${not empty message}">
    <div class="message">${message}</div>
</c:if>
<c:if test="${not empty error}">
    <div class="error">${error}</div>
</c:if>

<!-- Quick links -->
<div style="margin-bottom: 10px;">
    <a class="small-link" href="${pageContext.request.contextPath}/users-ui/register">Add User</a>
    <a class="small-link" href="${pageContext.request.contextPath}/owners-ui/register">Add Owner</a>
    <a class="small-link" href="${pageContext.request.contextPath}/owners-ui/add-app">Add App</a>
</div>

<!-- USERS SECTION -->
<div class="section-title">Users</div>
<table>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Username</th>
        <th>Email</th>
        <th>Mobile</th>
        <th>Actions</th>
    </tr>
    <c:forEach var="u" items="${users}">
        <tr>
            <td>${u.userId}</td>
            <td>${u.firstName} ${u.lastName}</td>
            <td>${u.userName}</td>
            <td>${u.email}</td>
            <td>${u.mobileNo}</td>
            <td>
                <form action="${pageContext.request.contextPath}/admins-ui/users/${u.userId}/delete"
                      method="post" style="display:inline">
                    <button type="submit" class="btn-delete">Delete</button>
                </form>
            </td>
        </tr>
    </c:forEach>
</table>

<!-- APPS SECTION -->
<div class="section-title">Apps</div>
<table>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Owner ID</th>
        <th>Genre</th>
        <th>Type</th>
        <th>Rating</th>
        <th>Actions</th>
    </tr>
    <c:forEach var="a" items="${apps}">
        <tr>
            <td>${a.appId}</td>
            <td>${a.appName}</td>
            <td>${a.appOwnerId}</td>
            <td>${a.genre}</td>
            <td>${a.appType}</td>
            <td>${a.rating}</td>
            <td>
                <form action="${pageContext.request.contextPath}/admins-ui/apps/${a.appId}/delete"
                      method="post" style="display:inline">
                    <button type="submit" class="btn-delete">Delete</button>
                </form>
            </td>
        </tr>
    </c:forEach>
</table>

<!-- OWNERS SECTION -->
<div class="section-title">App Owners</div>
<table>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Username</th>
        <th>Email</th>
        <th>Mobile</th>
        <th>Actions</th>
    </tr>
    <c:forEach var="o" items="${owners}">
        <tr>
            <td>${o.ownerId}</td>
            <td>${o.firstName} ${o.lastName}</td>
            <td>${o.userName}</td>
            <td>${o.email}</td>
            <td>${o.mobile}</td>
            <td>
                <form action="${pageContext.request.contextPath}/admins-ui/owners/${o.ownerId}/delete"
                      method="post" style="display:inline">
                    <button type="submit" class="btn-delete">Delete</button>
                </form>
            </td>
        </tr>
    </c:forEach>
</table>

</body>
</html>
